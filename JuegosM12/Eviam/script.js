
level1 = [
    [1,1,1,0,1,1,1,0,1,1,1,1,1],
    [0,0,1,1,1,0,0,0,1,0,0,0,1],
    [1,1,1,0,1,1,1,0,1,0,1,1,1],
    [1,0,1,0,1,0,1,1,1,0,1,0,0],
    [1,0,1,0,1,0,1,0,1,0,1,1,1],
    [1,1,1,0,1,0,1,1,1,0,0,0,1],
    [1,0,0,0,1,0,1,0,1,1,1,0,3]
];


level2 = [
    [1, 1, 1, 1 ,1 ,1 ,1 ,0 ,1 ,1 ,1 ,1 ,1 ,0 ,1 ,1 ,1 ,1 ,0 ,1 ,1 ,1],
    [0, 0, 1, 0 ,0 ,0 ,1 ,1 ,1 ,0 ,0 ,0 ,1 ,0 ,0 ,1 ,0 ,1 ,0 ,1 ,0 ,1],
    [1, 0, 1, 1 ,1 ,0 ,0 ,0 ,1 ,0 ,1 ,1 ,1 ,1 ,1 ,1 ,0 ,1 ,0 ,0 ,0 ,1],
    [1, 0, 0, 0 ,1 ,1 ,1 ,0 ,1 ,1 ,1 ,1 ,0 ,0 ,0 ,0 ,0 ,1 ,1 ,0 ,1 ,1],
    [1, 1, 1, 0 ,1 ,0 ,1 ,0 ,0 ,0 ,0 ,1 ,0 ,1 ,1 ,1 ,0 ,0 ,1 ,1 ,1 ,0],
    [1, 0, 0, 1 ,1 ,0 ,1 ,1 ,1 ,1 ,0 ,1 ,1 ,1 ,0 ,1 ,1 ,0 ,0 ,0 ,1 ,0],
    [1, 1, 0, 0 ,0 ,0 ,0 ,1 ,0 ,1 ,0 ,0 ,0 ,0 ,0 ,0 ,1 ,1 ,1 ,1 ,1 ,0],
    [0, 1, 1, 1 ,0 ,1 ,0 ,1 ,0 ,1 ,0 ,1 ,1 ,1 ,0 ,1 ,1 ,0 ,1 ,0 ,1 ,1],
    [0, 0, 0, 1 ,0 ,1 ,0 ,1 ,0 ,0 ,0 ,1 ,0 ,1 ,1 ,1 ,0 ,0 ,1 ,0 ,0 ,1],
    [1, 0, 1, 1 ,0 ,1 ,1 ,1 ,0 ,1 ,1 ,1 ,0 ,1 ,0 ,0 ,0 ,1 ,1 ,0 ,1 ,1],
    [1, 1, 1, 0 ,0 ,0 ,0 ,0 ,0 ,1 ,0 ,0 ,0 ,1 ,1 ,1 ,1 ,1 ,0 ,0 ,1 ,0],
    [1, 0, 0, 0 ,1 ,1 ,1 ,0 ,3 ,1 ,0 ,1 ,1 ,1 ,0 ,0 ,0 ,1 ,1 ,1 ,1 ,1],
    [1, 0, 1, 1 ,1 ,0 ,0 ,0 ,0 ,0 ,0 ,1 ,1 ,1 ,0 ,1 ,1 ,0 ,1 ,0 ,0 ,1],
    [1, 1, 1, 0 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,0 ,1 ,1 ,1 ,0 ,0 ,1 ,1 ,0 ,1]
];



// level3 = [
//     [1,1,1,0,1,1,1,0,1,1,1,0,1,1,1,0,1,1],
//     [0,0,1,1,0,1,0,0,0,1,1,0,1,1,1,0,1,1],
//     [1,1,1,0,1,1,1,0,1,0,1,0,1,1,1,1,1,1],
//     [1,0,1,0,0,1,0,1,1,1,1,0,1,1,1,0,1,1],
//     [1,1,1,0,0,1,1,1,0,0,1,0,1,1,1,0,1,1],
//     [1,1,1,1,1,1,1,0,0,0,1,0,1,1,1,0,1,1],
//     [1,1,1,0,1,1,1,0,1,0,1,1,1,1,1,0,1,1],
//     [1,1,1,0,1,1,1,0,0,0,1,0,1,1,1,0,1,1],
//     [1,0,0,0,1,0,1,0,1,1,1,0,1,1,1,0,1,1]
// ];

level3 = [
    [1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1],
    [0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1],
    [1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1],
    [1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0],
    [1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0],
    [0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1],
    [1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0],
    [1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0],
    [1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1],
    [0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1],
    [1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1],
    [1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0],
    [1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1],
    [0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1],
    [1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 3]

];


// Hector TIP escalabilidad --> array con las posiciones que no puede pasar
let mazeArray = level1;
let chooseLevel = document.getElementById("levelSelect");
let title = document.getElementById("title");
let back = document.getElementById("back");
let counterElement = document.getElementById("counter");
let again = document.getElementById("again");
let maze = document.getElementById("maze-container");
let warrior = document.getElementById("warrior");
let door = document.getElementById("door");
let winPos = false;
let counter = 0;


function winPosition (mazeArray)
{
    let position = [-1 , -1];
    for (let i = 0; i < mazeArray.length; i++) {
        for (let j = 0; j < mazeArray[i].length; j++) {
            if (mazeArray[i][j] == 3)  {
                position[0] = i;
                position[1] = j;
            }
        }
    }
    // console.log("warrior position is " + position);
    return position;
};

chooseLevel.addEventListener("change",
function()
{
    let level = chooseLevel.value;
    console.log(level);

    if (level == 1)
    {
        mazeArray = level1;
        winPosition = winPosition(mazeArray);
    };
    if (level == 2)
    {
        mazeArray = level2;
        winPosition = winPosition(mazeArray);
    };
    if (level == 3)
    {
        mazeArray = level3;
        winPosition = winPosition(mazeArray);
    };

    maze.innerHTML =
    '<img src="images/warrior/warrior_down.gif" alt="warrior" id="warrior" height="50px" width="50px"> <div id="lantern"></div> <div id="lanternDoor"></div>'
    createMaze();
    console.log(mazeArray[0].length);
    console.log("win position is:" + winPosition);
    
});
    



function createMaze()
{
    buttons();

    for (let i = 0; i < mazeArray.length; i++) {
        let row = document.createElement("div");
        row.classList.add("row");

        for (let j = 0; j < mazeArray[i].length; j++) {
            let cell = document.createElement("div");
            cell.classList.add("cell");

            if (mazeArray[i][j] == 0) {
                cell.classList.add("wall");
            }
            
            if (i == 0 && j == 0) {
                mazeArray[i][j] = 2;
            }

            if (mazeArray[i][j] == 3) {
                cell.classList.add("door");
            }
            row.appendChild(cell);
        
        }
        maze.appendChild(row);
    }
    console.log("La lenght de la array es de " + mazeArray.length);

    //setWarriorPosition(0,0);
}

function getWarriorPosition()
{
    let position = [-1 , -1];
    for (let i = 0; i < mazeArray.length; i++) {
        for (let j = 0; j < mazeArray[i].length; j++) {
            if (mazeArray[i][j] == 2)  {
                position[0] = i;
                position[1] = j;
            }
        }
    }
    // console.log("warrior position is " + position);
    return position;
}

function win(warriorPosition)
{
    warriorPosition = getWarriorPosition();
    console.log(warriorPosition);
    console.log(winPosition);

    if (warriorPosition[0] == winPosition[0] && warriorPosition[1] == winPosition[1])
    {
        winPos = true;
        alert("You win You win");
        endGame()
    }
}


document.addEventListener("keydown",
    function(e)
    {
        let warrior= document.getElementById("warrior");
        let warriorLeft = warrior.offsetLeft;
        let warriorTop = warrior.offsetTop;
        let warriorPosition = getWarriorPosition();
        let lantern= document.getElementById("lantern");

        if (e.key == "ArrowRight")
        {
            if (warriorLeft < (mazeArray[0].length - 1) * 50)
            {
                if (mazeArray[warriorPosition[0]][warriorPosition[1] + 1] >= 1)
                {
                    warriorLeft += 52;
                    warrior.style.left = warriorLeft + "px";
                    mazeArray[warriorPosition[0]][warriorPosition[1]] = 1;
                    mazeArray[warriorPosition[0]][warriorPosition[1] + 1] = 2;
                }
                //getWarriorPosition();
            }
        }
        if (e.key == "ArrowLeft")
        {
            if (warriorLeft > 0)
            {
                if (mazeArray[warriorPosition[0]][warriorPosition[1] - 1] >= 1)
                {
                    warriorLeft -= 52;
                    warrior.style.left = warriorLeft + "px";
                    // changes the number (in mazeArray) where it was from 2 to 1
                    mazeArray[warriorPosition[0]][warriorPosition[1]] = 1;
                    // changes the number (in mazeArray) where the movement continues from 1 to 2
                    mazeArray[warriorPosition[0]][warriorPosition[1] - 1] = 2;
                }
            }
        }
        if (e.key == "ArrowUp")
        {
            if (warriorTop > 0)
            {
                if (mazeArray[warriorPosition[0] - 1][warriorPosition[1]] >= 1)
                {
                    warriorTop -= 52;
                    warrior.style.top = warriorTop + "px";
                    mazeArray[warriorPosition[0]][warriorPosition[1]] = 1;
                    mazeArray[warriorPosition[0] - 1][warriorPosition[1]] = 2;
                }
            }
        }
        if (e.key == "ArrowDown")
        {
            if (warriorTop < (mazeArray.length - 1) * 50)
            {
                if (mazeArray[warriorPosition[0] + 1][warriorPosition[1]] >= 1)
                {
                    warriorTop += 52;
                    warrior.style.top = warriorTop + "px";
                    mazeArray[warriorPosition[0]][warriorPosition[1]] = 1;
                    mazeArray[warriorPosition[0] + 1][warriorPosition[1]] = 2;
                }
            }
        }
        lantern.style.top = (warriorTop + (warrior.offsetHeight/2) - (lantern.offsetHeight /2)) + 'px';
        lantern.style.left = (warriorLeft + (warrior.offsetWidth/2) - (lantern.offsetWidth /2)) + 'px';
        win(warriorPosition);
        console.log(mazeArray);


        console.log("WARRIOR POSITION IS: " + warriorPosition);

        // if ( mazeArray[warriorPosition[0]][warriorPosition[1]] == mazeArray[13][20])
        // {
        //     powerUP();
        // }

    }

       // if warrior arrive here, win!
    //    if (warriorPosition == 2 && mazeArray == 2)
    //    {
    //        alert
    //    }
    //    console.log(mazeArray);
);

function powerUP ()
{
    lantern.style.background = "radial-gradient(circle at 1500px 1500px, transparent 0%, black " + 1000 + "px)";
};

function buttons()
{
    maze.style.display = 'block';
    back.style.display = 'flex';
    counterElement.style.display = 'flex';
    chooseLevel.style.display = 'none';
    title.style.fontSize = '60px';
};

function endGame()
{
    maze.style.display = 'none';
    back.style.display = 'none';
    again.style.display = 'flex';
    counterElement.style.display = 'none';
    chooseLevel.style.display = 'none';
    title.style.fontSize = '60px';
};

back.addEventListener("click",
    function()
    {
        console.log('back');
        maze.style.display = 'none';
        title.style.fontSize = '150px';
        back.style.display = 'none';
        counterElement.style.display = 'none';
        chooseLevel.style.display = 'block';
        mazeArray = [];
        console.log(mazeArray);
    }
);

let counterId = setInterval(()=>{
    counter++;

    if(winPos == true)
    {
        clearInterval(counterId)
    }
    else
    {
        counterElement.innerText = counter;
    }
},1000)
        

